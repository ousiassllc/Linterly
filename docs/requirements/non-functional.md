# 非機能要件

## 1. 性能

| 項目 | 要件 |
|------|------|
| 小規模プロジェクト（〜1,000 ファイル） | 1 秒以内にチェック完了 |
| 中規模プロジェクト（〜10,000 ファイル） | 5 秒以内にチェック完了 |
| 大規模プロジェクト（〜100,000 ファイル） | 30 秒以内にチェック完了 |
| メモリ使用量 | ファイルを逐次処理し、全ファイルを同時にメモリに保持しない |

### 性能方針

- ファイル走査は並行処理（goroutine）を活用する
- 行数カウントはバッファ付き I/O で効率的に処理する
- 除外パターンはディレクトリ走査時に早期適用し、不要なファイルアクセスを避ける

## 2. 対応プラットフォーム

### OS

| OS | アーキテクチャ |
|----|--------------|
| Linux | amd64, arm64 |
| macOS | amd64 (Intel), arm64 (Apple Silicon) |
| Windows | amd64 |

### ランタイム要件

- 外部ランタイム不要（シングルバイナリ）
- Go でクロスコンパイルし、各プラットフォーム向けバイナリを提供する

## 3. 配布形態

| 形態 | パッケージ名 | 配布先 | 備考 |
|------|------------|--------|------|
| スタンドアロン CLI | `linterly` | GitHub Releases | 各 OS/アーキテクチャ向けバイナリ |
| npm パッケージ（メイン） | `@linterly/cli` | npm registry | 薄い JS ラッパー。`optionalDependencies` で各プラットフォーム用パッケージを参照。`npx @linterly/cli` で即実行可能 |
| npm パッケージ（バイナリ） | `@linterly/darwin-arm64` 等 | npm registry | プラットフォーム別の Go バイナリを同梱。npm が現在の OS に合うものだけを自動インストール |
| Go モジュール | `github.com/ousiassllc/linterly` | Go module proxy | `go install` で直接インストール可能 |
| cargo crate | `linterly` | crates.io | Go バイナリをラップ。`build.rs` でバイナリをダウンロード |
| pip パッケージ | `linterly` | PyPI | Go バイナリをラップ。プラットフォーム対応 wheel で配布 |
| Docker イメージ | `ghcr.io/ousiassllc/linterly` | GitHub Container Registry | Alpine ベースの軽量イメージ |
| GitHub Action | `ousiassllc/linterly-action` | GitHub Marketplace | Docker ベースまたはコンポジットアクション |

### 配布方針

- **コアは Go バイナリ 1 つ**。各パッケージマネージャ向けにはラッパーを提供する
- npm はプラットフォーム別パッケージ方式（esbuild / Biome と同方式）を採用する
- cargo / pip のラッパーは、インストール時にプラットフォーム対応バイナリをダウンロードする仕組み
- Go ユーザーは `go install` で直接バイナリを取得できる
- CI/CD 向けには GitHub Action と Docker イメージを提供する
- リリースは GitHub Actions で全配布形態を自動ビルド・publish する

## 4. 国際化（i18n）

| 項目 | 要件 |
|------|------|
| 対応言語 | 英語（en）、日本語（ja） |
| デフォルト言語 | 英語（en） |
| 言語切替方法 | 設定ファイルの `language` パラメータで指定 |
| 対象範囲 | CLI 出力メッセージ（エラー、警告、ヘルプテキスト） |
| 対象外 | 設定ファイルのキー名、JSON 出力のキー名（常に英語） |

### メッセージ管理方針

- メッセージは Go の `embed` パッケージで埋め込んだ YAML/JSON ファイルで管理する
- メッセージキーは英語ベースの識別子（例: `err.file_too_long`）
- 将来的な言語追加が容易な構造とする

## 5. セキュリティ

| 項目 | 要件 |
|------|------|
| ファイルアクセス | 読み取り専用。ユーザーのソースコードを外部に送信しない |
| 設定ファイル | ローカルファイルのみ。リモート設定の読み込みは行わない |
| バイナリ配布 | GitHub Releases でチェックサム（SHA256）を提供する |
| 依存関係 | 最小限に抑え、定期的に脆弱性スキャンを実施する |

## 6. 保守性

| 項目 | 要件 |
|------|------|
| テストカバレッジ | コア機能は 80% 以上を目標とする |
| CI/CD | GitHub Actions でテスト・ビルド・リリースを自動化する |
| リリース | セマンティックバージョニング（SemVer）に従う |
| ドキュメント | README、CLI ヘルプ、設定ファイルリファレンスを提供する |

## 7. アクセシビリティ

| 項目 | 要件 |
|------|------|
| カラー出力 | `NO_COLOR` 環境変数に準拠し、設定時はカラー出力を無効化する（[no-color.org](https://no-color.org)） |

## 8. 互換性

| 項目 | 要件 |
|------|------|
| Go バージョン | Go 1.22 以上でビルド可能 |
| 設定ファイル | 後方互換性を維持する。破壊的変更はメジャーバージョンアップ時のみ |
| CLI インターフェース | フラグ・サブコマンドの削除・変更はメジャーバージョンアップ時のみ |

## 改訂履歴

| 版 | 日付 | 変更内容 | 変更理由 |
|---|------|---------|---------|
| 1.0 | 2026-02-08 | 初版作成 | — |
| 1.1 | 2026-02-08 | アクセシビリティ（NO_COLOR 対応）を追加 | 整合性チェックによる改善 |
